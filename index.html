<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Interview Links</title>
    <link rel="stylesheet" href="./css/bootstrap.css">
    <link rel="stylesheet" href="./css/bootstrap-reboot.css">
    <link rel="stylesheet" href="./css/bootstrap-grid.css">
    <link rel="stylesheet" href="./css/brand.css">
</head>
<body>
<div class="jumbotron jumbotron-fluid mb-1">
    <div class="container">
        <h1 class="display-4">Trilogy Interviewing Guide</h1>
        <p class="lead">Reduce setup time. Find all the important links in seconds.</p>
    </div>
</div>
<!--<pre id="content"></pre>-->
<div class="card interviews--card mb-4">
    <div class="container">
        <div class="card-body">
            <h5 class="card-title" id="interview-card-title"></h5>
            <ul id="content"></ul>
        </div>
    </div>
</div>
<div class="container">
    <div class="row ">
        <div class="col-sm-12">
            <div class="float-right">
                <button id="authorize_button" class="btn btn-primary">Pull Google Cal Info</button>
            </div>
        </div>
    </div>
    <div class="row">
        <h1 class="h3 mb-3">Quick Links</h1>
        <div class="col-12">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="fsf-tab" data-toggle="tab" href="#fsf" role="tab" aria-controls="fsf" aria-selected="true">FSF</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="dv-tab" data-toggle="tab" href="#dv" role="tab" aria-controls="dv" aria-selected="false">DV</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="ux-ui-tab" data-toggle="tab" href="#ux-ui" role="tab" aria-controls="ux-ui" aria-selected="false">Ux/Ui</a>
                </li>
            </ul>
            <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active" id="fsf" role="tabpanel" aria-labelledby="fsf-tab">
                    <ol>
                        <li> Check List
                            <a href="https://docs.google.com/document/d/1Fz_Xf_rvI4K6rmy3BZGuK0cLU6Ma12EXMiJyo7kWVeQ/edit"
                               target="_blank">Found Here</a>
                        </li>
                        <li> Broken Code Example
                            <a href="code-smaples/demo.html" class="btn btn-outline-secondary btn-sm" download>Download Code</a>
                            <a href="#show-code--link" id="show-code--link" class="btn btn-primary btn-sm">Code Copy</a>
                            <code id="code-block" class="d-none">
                            <xmp class="language-html" data-lang="html">

<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"> <title>intro js</title> <!-- Latest compiled and minified CSS --> <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css"> <!-- Optional theme --> <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css"> <style type="text/css"> .marginUp {margin-top: 75px; } .marginDown {margin-bottom: 200px; } .marginUpSmall {margin-top: 25px; } .marginDownSmall{margin-bottom: 25px; } </style>
</head>
<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="#">Example 6</a> </div> <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="#">Home</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
        <pre id="content"></pre>
      <div class="starter-template">
        <h1 id="main-heading" class="text-center marginUp">Data Attributes</h1>
        <p class="lead text-center" id="heading-text">are awesome</p>

        <div class="row marginDown">
            <div class="col-md-6 col-md-offset-4">

                <div id="mainButtons">
<button data-tvshow="earth">1</button>
<button data-tvshow="fire">2</button> <button data-tvshow="wind">3</button> <button data-tvshow="water">4</button> <button data-tvshow="heart">5</button> <button data-tvshow="go-planet">6</button> </div> <br> <a id="addButtonAbove" href="#">add another button above</a> </div> </div> </div> </div><!-- /.container -->

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

<script type="text/javascript">
( document ).ready(function() {

    ('button').on('click', function(){
        var part = $(this).data('tvshow');

        alert part);
});

$('#addButtonAbove').on('click', function(){
    var newButton = $('<button/>');

    newButton.html("click here to find out the tv show's name")

    newButton.attr('data-tvshow', 'Captain Planet!')

    newButton.appendTo( $('#mainButtons') )
});

});
</script>


</body>
</html>
                            </xmp>
                            </code>
                        </li>
                        <li> Interview Script
                            <a href="https://docs.google.com/document/d/1UiOulvVFKj7v92qG7-QFTfpsVzthIF1D9isRIhKA6E0"
                               target="_blank">Found Here !</a>
                        </li>
                        <li> Google form to score
                            <a href="https://docs.google.com/forms/u/7/d/e/1FAIpQLSfshnjYFC8TImYze9qPOPSGNZxWufMIVLtoRc7Kj3WbLxCRsg/formResponse"
                               target="_blank">Found Here</a>
                        </li>
                        <li> Update the Matrix
                            <a href="https://docs.google.com/spreadsheets/d/12eadVv6t9vStFOEyoCdCvxU_GhndibefOXWrOR7OkG8/edit#gid=0"
                               target="_blank">Found Here</a>
                        </li>
                        <li> Follow Up Interview
                            <a href="https://interviewfollowup.youcanbook.me/"
                               target="_blank">Found Here</a>
                        </li>
                    </ol>
                </div>
                <div class="tab-pane fade" id="dv" role="tabpanel" aria-labelledby="dv-tab">
                    <ol>
                        <li> Check List
                            <a href="https://docs.google.com/document/d/1K2UD3jtb9gdUgA2L98RewPm6UuMGF7A-z5_Fk4Xr8CU/edit"
                               target="_blank">Found Here</a>
                        </li>
                        <li> Broken Code Example
                            <a href="code-smaples/unsolved.zip" class="btn btn-outline-secondary btn-sm" download>Download Code Folder Code</a>
                            <a href="#show-code--link__dv" class="btn btn-primary btn-sm">Code Copy</a>
                            <code id="code-block__dv" class="d-none">
                                <xmp class="language-html" data-lang="html">
                                    '''
                                    Weather Finder
                                    ===============
                                    The code should retrieve the current weather of each city listed in the provided csv file using the OpenWeatherMap API.
                                    It should then print a running list of JSONs for each city in the console.
                                    It should finally save the city names and temperatures in a new csv.

                                    '''

                                    # Dependencies
                                    import requests as req
                                    import json
                                    import csv

                                    # OpenWeather API Key
                                    api_key = "6bcabf9648fe4420192e0190f0d04a23 "

                                    # Specify File Path
                                    csvpath = "cities.txt"

                                    # Read CSV
                                    with open(csvpath) as csvfile:

                                    # Read the file specifying commas as delimiters
                                    csvreader = csv.reader(csvfile, delimiter=",")

                                    # Iterate through each row of the CSV
                                    for row in csvreader:

                                    # Print each row of the csv
                                    print(row[0])

                                    # Build an endpoint URL to the OpenWeatherMap Service
                                    url = "http://api.openweathermap.org/data/2.5/weather?"
                                    query_url = url + "q=" + city + "&appid=" + api_key + "&units=Imperial"

                                    # Make a request to the endpoint url
                                    weather_response = req.get(query_url)
                                    weather_json = weather_response.json()

                                    # Print the JSON for each
                                    print(weather_json)

                                    # Extract the temperature for each city
                                    temperature = weather_json["main"]["temperature"]

                                    # Print the Temperatures
                                    print(temperature)

                                    # Draw a separating line
                                    print("---------------")

                                    # Write the contents for each to a new CSV
                                    output_file = "output.csv"
                                    with open(output_file, "w") as csvfile:

                                    # Initialize the csv.writer
                                    csvwriter = csv.writer(csvfile, delimiter=",")

                                    # Write each row
                                    csvwriter.writerow([row[0], temperature])


                                </xmp>
                            </code>
                        </li>
                        <li> Interview Script
                            <a href="https://drive.google.com/open?id=10yFtRpw6o6pm0LKBdDb4PGebvh3DtplMj4_qsgQkQLY"
                               target="_blank">Found Here !</a>
                        </li>
                        <li> Google form to score
                            <a href="https://docs.google.com/forms/u/7/d/e/1FAIpQLSfshnjYFC8TImYze9qPOPSGNZxWufMIVLtoRc7Kj3WbLxCRsg/formResponse"
                               target="_blank">Found Here</a>
                        </li>
                        <li> Update the Matrix
                            <a href="https://docs.google.com/spreadsheets/d/12eadVv6t9vStFOEyoCdCvxU_GhndibefOXWrOR7OkG8/edit#gid=0"
                               target="_blank">Found Here</a>
                        </li>
                        <li> Follow Up Interview
                            <a href="https://interviewfollowup.youcanbook.me/"
                               target="_blank">Found Here</a>
                        </li>
                    </ol>
                </div>
                <div class="tab-pane fade" id="ux-ui" role="tabpanel" aria-labelledby="contact-tab">...</div>
            </div>
        </div>

    </div>

</div>

<script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
<script src="js/bootstrap.js"></script>
<script src="js/moment.js"></script>
<script src="js/clipboard-pollyfill.js"></script>
<script type="text/javascript">
//    https://developers.google.com/calendar/quickstart/js?authuser=3#troubleshooting
    // Client ID and API key from the Developer Console
    var CLIENT_ID = '201807512114-kver87m84oe0po9d2hif2hcmvuq46mq5.apps.googleusercontent.com';
    var API_KEY = 'AIzaSyArMptJ0T2l41ip1jAll-PGVMZZrrDS0Q8';

    // Array of API discovery doc URLs for APIs used by the quickstart
    var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];

    // Authorization scopes required by the API; multiple scopes can be
    // included, separated by spaces.
    var SCOPES = "https://www.googleapis.com/auth/calendar.readonly";

    var authorizeButton = document.getElementById('authorize_button');
    var signoutButton = document.getElementById('signout_button');

    /**
     *  On load, called to load the auth2 library and API client library.
     */
    function handleClientLoad() {
        gapi.load('client:auth2', initClient);
    }

    /**
     *  Initializes the API client library and sets up sign-in state
     *  listeners.
     */
    function initClient() {
        gapi.client.init({
            apiKey: API_KEY,
            clientId: CLIENT_ID,
            discoveryDocs: DISCOVERY_DOCS,
            scope: SCOPES
        }).then(function () {
            // Listen for sign-in state changes.
            gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

            // Handle the initial sign-in state.
            updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            authorizeButton.onclick = handleAuthClick;
//            signoutButton.onclick = handleSignoutClick;
        });
    }

    /**
     *  Called when the signed in status changes, to update the UI
     *  appropriately. After a sign-in, the API is called.
     */
    function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
            authorizeButton.style.display = 'none';
//            signoutButton.style.display = 'block';
            listUpcomingEvents();
        } else {
            authorizeButton.style.display = 'block';
//            signoutButton.style.display = 'none';
        }
    }

    /**
     *  Sign in the user upon button click.
     */
    function handleAuthClick(event) {
        gapi.auth2.getAuthInstance().signIn();
    }

    /**
     *  Sign out the user upon button click.
     */
    function handleSignoutClick(event) {
        gapi.auth2.getAuthInstance().signOut();
    }

    /**
     * Append a pre element to the body containing the given message
     * as its text node. Used to display the results of the API call.
     *
     * @param {string} message Text to be placed in pre element.
     */
    function appendPre(summary, description) {
        var contentDiv = $('#content');
        var liElement = $('<li class="interview--detail">'+summary+'</li>');
        var aElement = $('<a href="#" class=".interview--link__view-more"> show details</a>');
        var detailsPre = $('<pre class="d-none">'+description+'</pre>');
//        var detailsPre = $('<pre style="display: none">'+description+'</pre>');

        contentDiv.append(liElement);
        liElement.append(aElement);
        liElement.append(detailsPre);
    }

    /**
     * Print the summary and start datetime/date of the next ten events in
     * the authorized user's calendar. If no events are found an
     * appropriate message is printed.
     */
    function listUpcomingEvents() {
        var todaysDate = moment().format("YYYY-MM-DD");
        var skippedInterviews = 0;
        console.log(todaysDate + 'T00:00:00.000Z');

        gapi.client.calendar.events.list({
            'calendarId': 'primary',
            // 'timeMin': todaysDate + 'T00:00:00.000Z',
            'timeMin': '2018-08-11T00:00:00.000Z',
            'showDeleted': false,
            'singleEvents': true,
            'maxResults': 10,
            'orderBy': 'startTime'
        }).then(function(response) {
            var events = response.result.items;

            document.getElementById('interview-card-title').innerHTML = 'Today\'s Interviews';
            if (events.length > 0) {
                for (i = 0; i < events.length; i++) {
                    var event = events[i];
                    var when = event.start.dateTime;
                    if (!when) {
                        when = event.start.date;
                    }
                    // if( event.summary.includes('Interview Booked') && when.includes(todaysDate) ){
                        if( event.summary.includes('Interview Booked') && when.includes(todaysDate) ){
                        appendPre(event.summary + ' (' + when + ')', event.description)
                    } else {
                        skippedInterviews++;
                    }
                }
                updateTextStatus(skippedInterviews);
            } else {
                document.getElementById('interview-card-title').innerHTML='No Interviews for today.';
            }

            function updateTextStatus(skipNumber){
                var pre = document.getElementById('content');
                if(skipNumber === 10){
                    document.getElementById('interview-card-title').innerHTML='No Interviews for today.';
                }
            }
        });
    }

    $( '#show-code--link' ).on('click',function() {
        var copyHTML = $('#code-block').html();
        clipboard.writeText( copyHTML );
    });
    $(document).ready(function () {

        $(document).on('click', '#content .interview--detail a', function (e) {
        console.log(e);
            var detailsTag = $(this).next('pre');
            detailsTag.toggleClass('d-none');

            if(detailsTag.css('display') !== 'none'){
                $(this).html(' hide details');
            } else {
                $(this).html(' show details');
            }
        })
    });
</script>
<script async defer src="https://apis.google.com/js/api.js"
        onload="this.onload=function(){};handleClientLoad()"
        onreadystatechange="if (this.readyState === 'complete') this.onload()">
</script>
</body>
</html>